#include <time.h>
#include <stdio.h>
#include <conio.h>
#include <stdlib.h>
#include <windows.h>


void exit(int status);// funkcja wyjscia

int random()
{
	int c,i, z;
    time_t tt;
    z = time(&tt);
    srand(z);
    c=rand()%4;
    return c;
}

int main(){

	int i,j,y,x,m,n;// i j tworzy tablice x y to wspolrzedne m n to tablica podgladowa
	int u, q,z, t, stala;// liczby losowe do wypisania min
	char k;// k to klawisz 
	int a,b,c,r; // a i b wspolrzedne min
	nowy:;// po przegranej od nowa
	x = 1;//wspolrzedne w tablicy poczatkowe WAZNE!
	y = 1;
system("color 3F");// kolor tla i ikonek
	char podglad[20][20] = {// tablica podgladowa "pierwsza klatka"
	{254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254},
	{254,169,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254},
	};
for (m=0;m<20;m++){//wyswietl tablice pogladowa
	for(n=0;n<20;n++){
		printf("%c ", podglad[m][n]);
	}
	printf("\n");
}
start:;
	r = random();
	char pole[20][20] = { // char 15 to bedzie mina
	{254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',254},
	{254,' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',35},
	{254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254},
	};
	znak:;//po wpisaniu blednego znaku
k = getch();// pozwala na wpisanie znaku bez entera
system("cls");// czysci tablice zeby ja odswiezyc
if (k == 'w')pole[x][y-=1];
else if (k == 's')pole[x][y+=1];
else if (k == 'a')pole[x-=1][y];
else if (k == 'd')pole[x+=1][y];
else if (k == 'p')exit(1);
else goto znak;// po wpisaniu blednego znakua
for(t=1;t<19;t++){
	a=1;
	for(z=1;z<19;z++){
		pole[t][++z] = (char)15;
	}
	t+=2;
pole[t][z];
}
if (pole[y][x] == (char)254 || pole[y][x] == (char)15)goto lost; // warunki przegranej
if (pole[y][x] == (char)35)goto win;


for (j=0;j<20;j++){
	for(i=0;i<20;i++){
		printf("%c ", pole[j][i]);
			pole[y][x] = 169; //znaczek ludzika na ekranie (char)

	}
	printf("\n");
}
goto start;	//idzie do startu po ruchu powtarza petle
/* ZAKONCZENIE PRZEGRANA */
lost:;
system("color 4F"); // kolor po przegranej
printf("Przegrana! Nacisnij dwa razy enter aby zaczac ponownie lub P aby wyjsc\n");
k = getch();
if(k == 'p')exit(1);
getchar();
goto nowy;// zaczyna gre od znowa
return 0;
/* ZAKONCZENIE WYGRANA */
win:;// idz do wygranej jesli spelnily sie warunki
system("color 2E");
printf("wygrales!!! Nacisnij dwa razy enter aby zaczac ponownie lub P aby wyjsc\n");
k = getch();
if(k == 'p')exit(1);
getchar();
goto nowy;
return 0;
}

